var lat,lon;function pullWeather(){var c="011ffb7f7744c9434fcbcdc0c9a0b65f";var a="?units=si";var b="https://api.darksky.net/forecast/"+c+"/"+lat+","+lon+a;return $.ajax({url:b,dataType:"jsonp",success:function(d){console.log("Success! Displaying weather...");report(d)},error:function(){console.log("Unable to display weather.")}})}$.getJSON("https://ipinfo.io",function(b){console.log("IP address detected: "+b.ip+". Lat, Lon: "+lat+", "+lon);var a=b.loc.split(",");lat=a[0];lon=a[1];var c=b.country;if(b.country=="KR"){c="South Korea"}$("#location").html(b.city+", "+b.region+", "+c);pullWeather()});$("#accuracy").click(function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(c){lat=(c.coords.latitude).toFixed(3);lon=(c.coords.longitude).toFixed(3);console.log("HTML5 geolocation permitted. Lat, Lon: "+lat+", "+lon);var a="AIzaSyAMejMCinUM1S2dzyVCpJf9q-Ns-e1YSnw";var b="https://maps.googleapis.com/maps/api/geocode/json?latlng="+lat+","+lon+"&key"+a;$.getJSON(b,function(d){$("#location").html(d.results[(d.results.length-3)].formatted_address)});pullWeather()})}else{console.log("HTML5 geolocation not permitted.")}});function report(e){if(e.currently.icon){$("#icon").addClass("wi-forecast-io-"+e.currently.icon)}else{$("#icon").addClass("wi-cloud")}function f(k){var j="";switch(true){case (k<0):j="rgba(1, 1, 255, 1.0)";break;case ((k>=0)&&(k<4.44)):j="rgba(1, 146, 255, 1.0)";break;case ((k>=4.44)&&(k<10)):j="rgba(76, 192, 220, 1.0)";break;case ((k>=10)&&(k<15.56)):j="rgba(1, 255, 154, 1.0)";break;case ((k>=15.56)&&(k<21.11)):j="rgba(156, 255, 41, 1.0)";break;case ((k>=21.11)&&(k<26.67)):j="rgba(255, 248, 3, 1.0)";break;case ((k>=26.67)&&(k<32.22)):j="rgba(255, 163, 3, 1.0)";break;case ((k>=32.22)&&(k<37.78)):j="rgba(255, 87, 3, 1.0)";break;case (k>=37.78):j="rgba(255, 0, 0, 1.0)";break;default:j="pink";break}return j}var i=Math.round(e.currently.temperature);$("#tempC").html(i+"&deg;");$("#buttonM").html("C");$("#tempF").html(Math.round(i*1.8+32)+"&deg");$("#buttonI").html("F");$("body").css("background-color",f(i));$("#currentDescription").html(e.currently.summary);$("#dailySummaryM").html(e.daily.summary);var g=/([0-9]+°C)/g;var h=e.daily.summary.match(g);var c=Math.round(parseFloat(h)*1.8+32)+"°F";var a=(e.daily.summary).replace(h,c);$("#dailySummaryI").html(a);$("#windSpeedM").html((e.currently.windSpeed).toFixed(1)+" m/s ");$("#windSpeedI").html((e.currently.windSpeed*2.23694).toFixed(1)+" mph ");var d=Math.round(e.currently.windBearing);$("#compaz").addClass("towards-"+e.currently.windBearing+"-deg");function b(j){switch(true){case (((j>348.75)&&(j<=360))||((j>=0)&&(j<=11.25))):answer=j+"&deg N";break;case ((j>11.25)&&(j<=33.75)):answer=j+"&deg NNE";break;case ((j>33.75)&&(j<=56.25)):answer=j+"&deg NE";break;case ((j>56.25)&&(j<=78.75)):answer=j+"&deg ENE";break;case ((j>78.75)&&(j<=101.25)):answer=j+"&deg E";break;case ((j>101.25)&&(j<=123.75)):answer=j+"&deg ESE";break;case ((j>123.75)&&(j<=146.25)):answer=j+"&deg SE";break;case ((j>146.25)&&(j<=168.75)):answer=j+"&deg SSE";break;case ((j>168.75)&&(j<=191.25)):answer=j+"&deg S";break;case ((191.25>j)&&(j<=213.75)):answer=j+"&deg SSW";break;case ((213.75>j)&&(j<=236.25)):answer=j+"&deg SW";break;case ((j>236.25)&&(j<=258.75)):answer=j+"&deg WSW";break;case ((j>258.75)&&(j<=281.25)):answer=j+"&deg W";break;case ((j>281.25)&&(j<=303.75)):answer=j+"&deg WNW";break;case ((j>303.75)&&(j<=326.25)):answer=j+"&deg NW";break;case ((j>326.25)&&(j<=348.75)):answer=j+"&deg NNW";break;default:answer="";break}return answer}$("#windDeg").html(b(d));$("#pressureM").html(Math.round(e.currently.pressure)+" hPa");$("#pressureI").html(Math.round(e.currently.pressure*0.03)+" inHg");$("#humidity").html(Math.round(e.currently.humidity*100)+"%");if(e.currently.visibility!==undefined){$("#visibilityM").html((e.currently.visibility).toFixed(1)+" km");$("#visibilityI").html((e.currently.visibility*0.621).toFixed(1)+" mi")}else{$("#visibilityM, #visibilityI").html("Unavailable")}if(e.currently.cloudCover!==undefined){$("#clouds").html(e.currently.cloudCover+"%")}else{$("#clouds").html("Unavailable")}}$("#buttonM, #buttonI").click(function(){$("#tempC, #tempF").toggleClass("goAway");$("#windSpeedM, #windSpeedI").toggleClass("goAway");$("#visibilityM, #visibilityI").toggleClass("goAway");$("#pressureM, #pressureI").toggleClass("goAway");$("#buttonM, #buttonI").toggleClass("goAway");$("#dailySummaryM, #dailySummaryI").toggleClass("goAway")});